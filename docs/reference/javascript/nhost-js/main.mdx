Main entry point for the Nhost JavaScript SDK.

This package provides a unified client for interacting with Nhost services:

- Authentication
- Storage
- GraphQL
- Functions

## Example

You can import and use this package with:

```ts
import { createClient } from "@nhost/nhost-js";
```

and use it like:

```ts
const nhost = createClient({
  subdomain,
  region,
});

// Sign in with email/password
// This will create a session and persist it in the storage
// Subsequent calls will use the session from the storage
// If the session is about to expire, it will be refreshed
// automatically
await nhost.auth.signUpEmailPassword({
  email,
  password,
});

const uplFilesResp = await nhost.storage.uploadFiles({
  "file[]": [
    new File(["test1"], "file-1", { type: "text/plain" }),
    new File(["test2 is larger"], "file-2", { type: "text/plain" }),
  ],
});
console.log(JSON.stringify(uplFilesResp, null, 2));
// {
//   "data": {
//     "processedFiles": [
//       {
//         "id": "c0e83185-0ce5-435c-bd46-9841adc30699",
//         "name": "file-1",
//         "size": 5,
//         "bucketId": "default",
//         "etag": "\"5a105e8b9d40e1329780d62ea2265d8a\"",
//         "createdAt": "2025-05-09T17:26:04.579839+00:00",
//         "updatedAt": "2025-05-09T17:26:04.589692+00:00",
//         "isUploaded": true,
//         "mimeType": "text/plain",
//         "uploadedByUserId": "",
//         "metadata": null
//       },
//       {
//         "id": "3f189004-21fd-42d0-be1d-1ead021ab167",
//         "name": "file-2",
//         "size": 15,
//         "bucketId": "default",
//         "etag": "\"302e888c5e289fe6b02115b748771ee9\"",
//         "createdAt": "2025-05-09T17:26:04.59245+00:00",
//         "updatedAt": "2025-05-09T17:26:04.596831+00:00",
//         "isUploaded": true,
//         "mimeType": "text/plain",
//         "uploadedByUserId": "",
//         "metadata": null
//       }
//     ]
//   },
//   "status": 201,
//   "headers": {
//     "content-length": "644",
//     "content-type": "application/json; charset=utf-8",
//     "date": "Fri, 09 May 2025 17:26:04 GMT"
//   }
// }

const graphResp = await nhost.graphql.post({
  query: `
   query {
     files {
       name
       size
       mimeType
     }
   }
 `,
});

console.log(JSON.stringify(graphResp, null, 2));
// {
//   "body": {
//     "data": {
//       "files": [
//         {
//           "name": "file-1",
//           "size": 5,
//           "mimeType": "text/plain"
//         },
//         {
//           "name": "file-2",
//           "size": 15,
//           "mimeType": "text/plain"
//         }
//       ]
//     }
//   },
//   "status": 200,
//   "headers": {}
// }
```

## Classes

### NhostClient

Main client class that provides access to all Nhost services

#### Constructors

##### Constructor

```ts
new NhostClient(
   auth: Client,
   storage: Client,
   graphql: Client,
   functions: Client,
   sessionStorage: SessionStorage): NhostClient;
```

Create a new Nhost client. This constructor is reserved for advanced use cases.
For typical usage, use [createClient](#createclient) instead.

###### Parameters

| Parameter        | Type                                           | Description                                    |
| ---------------- | ---------------------------------------------- | ---------------------------------------------- |
| `auth`           | [`Client`](auth#client)                    | Authentication client                          |
| `storage`        | [`Client`](storage#client)                 | Storage client                                 |
| `graphql`        | [`Client`](graphql#client)                 | GraphQL client                                 |
| `functions`      | [`Client`](functions#client)               | Functions client                               |
| `sessionStorage` | [`SessionStorage`](session#sessionstorage) | Storage implementation for session persistence |

###### Returns

[`NhostClient`](#nhostclient)

#### Properties

| Property                                     | Type                                           | Description                                                                                   |
| -------------------------------------------- | ---------------------------------------------- | --------------------------------------------------------------------------------------------- |
| <a id="auth"></a> `auth`                     | [`Client`](auth#client)                    | Authentication client providing methods for user sign-in, sign-up, and session management     |
| <a id="functions"></a> `functions`           | [`Client`](functions#client)               | Functions client providing methods for invoking serverless functions                          |
| <a id="graphql"></a> `graphql`               | [`Client`](graphql#client)                 | GraphQL client providing methods for executing GraphQL operations against your Hasura backend |
| <a id="sessionstorage"></a> `sessionStorage` | [`SessionStorage`](session#sessionstorage) | Storage implementation used for persisting session information                                |
| <a id="storage"></a> `storage`               | [`Client`](storage#client)                 | Storage client providing methods for file operations (upload, download, delete)               |

#### Methods

##### clearSession()

```ts
clearSession(): void;
```

Clear the session from storage

###### Returns

`void`

##### getUserSession()

```ts
getUserSession(): null | Session;
```

Get the current session from storage

###### Returns

`null` \| [`Session`](auth#session)

The current session or null if no session exists

###### Example

```ts
const session = nhost.getUserSession();
if (session) {
  console.log("User is authenticated:", session.user.id);
} else {
  console.log("No active session");
}
```

##### refreshSession()

```ts
refreshSession(marginSeconds: number): Promise<null | Session>;
```

Refresh the session using the current refresh token
in the storage and update the storage with the new session.

###### Parameters

| Parameter       | Type     | Default value | Description                                                                                                                                                                       |
| --------------- | -------- | ------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `marginSeconds` | `number` | `60`          | The number of seconds before the token expiration to refresh the session. If the token is still valid for this duration, it will not be refreshed. Set to 0 to force the refresh. |

###### Returns

`Promise`&lt;`null` \| [`Session`](auth#session)&gt;

The new session or null if there is currently no session or if refresh fails

## Interfaces

### NhostClientOptions

Configuration options for creating an Nhost client

#### Extended by

- [`NhostServerClientOptions`](#nhostserverclientoptions)

#### Properties

##### authUrl?

```ts
optional authUrl: string;
```

Complete base URL for the auth service (overrides subdomain/region)

##### functionsUrl?

```ts
optional functionsUrl: string;
```

Complete base URL for the functions service (overrides subdomain/region)

##### graphqlUrl?

```ts
optional graphqlUrl: string;
```

Complete base URL for the GraphQL service (overrides subdomain/region)

##### region?

```ts
optional region: string;
```

Nhost region (e.g., 'eu-central-1'). Used to construct the base URL for services for the Nhost cloud.

##### storage?

```ts
optional storage: SessionStorageBackend;
```

Storage backend to use for session persistence. If not provided, the SDK will
default to localStorage in the browser or memory in other environments.

##### storageUrl?

```ts
optional storageUrl: string;
```

Complete base URL for the storage service (overrides subdomain/region)

##### subdomain?

```ts
optional subdomain: string;
```

Nhost project subdomain (e.g., 'abcdefgh'). Used to construct the base URL for services for the Nhost cloud.

---

### NhostServerClientOptions

Configuration options for creating an Nhost client

#### Extends

- [`NhostClientOptions`](#nhostclientoptions)

#### Properties

##### authUrl?

```ts
optional authUrl: string;
```

Complete base URL for the auth service (overrides subdomain/region)

###### Inherited from

[`NhostClientOptions`](#nhostclientoptions).[`authUrl`](#authurl)

##### functionsUrl?

```ts
optional functionsUrl: string;
```

Complete base URL for the functions service (overrides subdomain/region)

###### Inherited from

[`NhostClientOptions`](#nhostclientoptions).[`functionsUrl`](#functionsurl)

##### graphqlUrl?

```ts
optional graphqlUrl: string;
```

Complete base URL for the GraphQL service (overrides subdomain/region)

###### Inherited from

[`NhostClientOptions`](#nhostclientoptions).[`graphqlUrl`](#graphqlurl)

##### region?

```ts
optional region: string;
```

Nhost region (e.g., 'eu-central-1'). Used to construct the base URL for services for the Nhost cloud.

###### Inherited from

[`NhostClientOptions`](#nhostclientoptions).[`region`](#region)

##### storage

```ts
storage: SessionStorageBackend;
```

Storage backend to use for session persistence. If not provided, the SDK will
default to localStorage in the browser or memory in other environments.

###### Overrides

[`NhostClientOptions`](#nhostclientoptions).[`storage`](#storage-1)

##### storageUrl?

```ts
optional storageUrl: string;
```

Complete base URL for the storage service (overrides subdomain/region)

###### Inherited from

[`NhostClientOptions`](#nhostclientoptions).[`storageUrl`](#storageurl)

##### subdomain?

```ts
optional subdomain: string;
```

Nhost project subdomain (e.g., 'abcdefgh'). Used to construct the base URL for services for the Nhost cloud.

###### Inherited from

[`NhostClientOptions`](#nhostclientoptions).[`subdomain`](#subdomain)

## Functions

### createClient()

```ts
function createClient(options: NhostClientOptions): NhostClient;
```

Creates and configures a new Nhost client instance.

This helper method instantiates a fully configured Nhost client by:

- Instantiating the various service clients (auth, storage, functions and graphql)
- Configuring a session storage if none is provided
- Setting up the necessary middleware for automatic session management:
  - Automatically attaching the authorization token to requests
  - Refreshing the session when it expires
  - Applying session tokens to function calls

#### Parameters

| Parameter | Type                                        | Description                          |
| --------- | ------------------------------------------- | ------------------------------------ |
| `options` | [`NhostClientOptions`](#nhostclientoptions) | Configuration options for the client |

#### Returns

[`NhostClient`](#nhostclient)

A configured Nhost client

---

### createServerClient()

```ts
function createServerClient(options: NhostServerClientOptions): NhostClient;
```

Creates and configures a new Nhost client instance to be used on a server component or middleware.

This helper method instantiates a fully configured Nhost client by:

- Instantiating the various service clients (auth, storage, functions and graphql)
- Configuring a session storage if none is provided
- Setting up the necessary middleware for automatic session management:
  - Automatically attaching the authorization token to requests
  - Refreshing the session when it expires
  - Applying session tokens to function calls

#### Parameters

| Parameter | Type                                                    | Description                          |
| --------- | ------------------------------------------------------- | ------------------------------------ |
| `options` | [`NhostServerClientOptions`](#nhostserverclientoptions) | Configuration options for the client |

#### Returns

[`NhostClient`](#nhostclient)

A configured Nhost client
