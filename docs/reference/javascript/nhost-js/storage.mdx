This is the main module to interact with Nhost's Storage service.
Typically you would use this modula via the main [Nhost client](main#createclient)
but you can also use it directly if you have a specific use case.

## Error handling

The SDK will throw errors in most operations if the request return a status >=400 or
if the request fails entirely (i.e., due to network errors). A continuation you can see
how you can handle errors thrown by the SDK when the status is >=400.

```ts
// Needs the following imports:
//
// import {
//   type ErrorResponse,
// } from "@nhost/nhost-js/storage";
// import {
//   type FetchError,
// } from "@nhost/nhost-js/fetch";
//
const nhost = createClient({
  subdomain,
  region,
});
try {
  await nhost.storage.uploadFiles({
    "file[]": [new File(["test1"], "file-1", { type: "text/plain" })],
  });

  expect(true).toBe(false); // This should not be reached
} catch (error) {
  const err = error as FetchError<ErrorResponse>;
  console.log("Error:", err);
  // Error: {
  //   body: { error: { message: 'you are not authorized' } },
  //   status: 403,
  //   headers: {
  //     'content-length': '46',
  //     'content-type': 'application/json; charset=utf-8',
  //     date: 'Mon, 12 May 2025 08:18:52 GMT'
  //   }
  // }

  // error handling...
```

## Enumerations

### F

#### Enumeration Members

| Enumeration Member       | Value    |
| ------------------------ | -------- |
| <a id="auto"></a> `Auto` | `"auto"` |
| <a id="avif"></a> `Avif` | `"avif"` |
| <a id="jpeg"></a> `Jpeg` | `"jpeg"` |
| <a id="png"></a> `Png`   | `"png"`  |
| <a id="same"></a> `Same` | `"same"` |
| <a id="webp"></a> `Webp` | `"webp"` |

## Interfaces

### Client

Storage client interface providing methods for file operations

#### Properties

##### baseURL

```ts
baseURL: string;
```

Base URL for the storage service

##### deleteFile()

```ts
deleteFile: (id: string, options?: RequestInit) => Promise<FetchResponse<void>>;
```

Delete a file

###### Parameters

| Parameter  | Type          |
| ---------- | ------------- |
| `id`       | `string`      |
| `options?` | `RequestInit` |

###### Returns

`Promise`&lt;[`FetchResponse`](fetch#fetchresponse)&lt;`void`&gt;&gt;

##### getFile()

```ts
getFile: (id: string, params?: GetFileParams, options?: RequestInit) =>
  Promise<FetchResponse<Blob>>;
```

Download a file

###### Parameters

| Parameter  | Type                              |
| ---------- | --------------------------------- |
| `id`       | `string`                          |
| `params?`  | [`GetFileParams`](#getfileparams) |
| `options?` | `RequestInit`                     |

###### Returns

`Promise`&lt;[`FetchResponse`](fetch#fetchresponse)&lt;`Blob`&gt;&gt;

##### getFileMetadataHeaders()

```ts
getFileMetadataHeaders: (
  id: string,
  params?: GetFileMetadataHeadersParams,
  options?: RequestInit,
) => Promise<FetchResponse<void>>;
```

Retrieve file metadata using HTTP HEAD method

###### Parameters

| Parameter  | Type                                                            |
| ---------- | --------------------------------------------------------------- |
| `id`       | `string`                                                        |
| `params?`  | [`GetFileMetadataHeadersParams`](#getfilemetadataheadersparams) |
| `options?` | `RequestInit`                                                   |

###### Returns

`Promise`&lt;[`FetchResponse`](fetch#fetchresponse)&lt;`void`&gt;&gt;

##### getVersion()

```ts
getVersion: (options?: RequestInit) =>
  Promise<FetchResponse<VersionInformation>>;
```

Retrieves build and version information about the storage service

###### Parameters

| Parameter  | Type          |
| ---------- | ------------- |
| `options?` | `RequestInit` |

###### Returns

`Promise`&lt;[`FetchResponse`](fetch#fetchresponse)&lt;[`VersionInformation`](#versioninformation)&gt;&gt;

##### pushChainFunction()

```ts
pushChainFunction: (chainFunction: ChainFunction) => void;
```

Add a middleware function to the request chain

###### Parameters

| Parameter       | Type                                       | Description                |
| --------------- | ------------------------------------------ | -------------------------- |
| `chainFunction` | [`ChainFunction`](fetch#chainfunction) | Middleware function to add |

###### Returns

`void`

##### replaceFile()

```ts
replaceFile: (
  id: string,
  replaceFileBody: ReplaceFileBody,
  options?: RequestInit,
) => Promise<FetchResponse<FileMetadata>>;
```

Replace an existing file

###### Parameters

| Parameter         | Type                                  |
| ----------------- | ------------------------------------- |
| `id`              | `string`                              |
| `replaceFileBody` | [`ReplaceFileBody`](#replacefilebody) |
| `options?`        | `RequestInit`                         |

###### Returns

`Promise`&lt;[`FetchResponse`](fetch#fetchresponse)&lt;[`FileMetadata`](#filemetadata)&gt;&gt;

##### uploadFiles()

```ts
uploadFiles: (uploadFilesBody: UploadFilesBody, options?: RequestInit) =>
  Promise<FetchResponse<UploadFiles201>>;
```

Upload one or more files to storage

###### Parameters

| Parameter         | Type                                  |
| ----------------- | ------------------------------------- |
| `uploadFilesBody` | [`UploadFilesBody`](#uploadfilesbody) |
| `options?`        | `RequestInit`                         |

###### Returns

`Promise`&lt;[`FetchResponse`](fetch#fetchresponse)&lt;[`UploadFiles201`](#uploadfiles201)&gt;&gt;

---

### ErrorResponse

Error information returned by the API.

#### Properties

##### error?

```ts
optional error: ErrorResponseError;
```

Error details.

---

### ErrorResponseError

Error details.

#### Properties

##### message

```ts
message: string;
```

Human-readable error message.
Example - File not found

---

### FileMetadata

Comprehensive metadata information about a file in storage.

#### Properties

##### bucketId?

```ts
optional bucketId: string;
```

ID of the bucket containing the file.
Example - users-bucket

##### createdAt?

```ts
optional createdAt: string;
```

Timestamp when the file was created.
Example - 2023-01-15T12:34:56Z
Format - date-time

##### etag?

```ts
optional etag: string;
```

Entity tag for cache validation.
Example - "a1b2c3d4e5f6"

##### id?

```ts
optional id: string;
```

Unique identifier for the file.
Example - d5e76ceb-77a2-4153-b7da-1f7c115b2ff2

##### isUploaded?

```ts
optional isUploaded: boolean;
```

Whether the file has been successfully uploaded.
Example - true

##### metadata?

```ts
optional metadata: Record<string, any>;
```

Custom metadata associated with the file.

##### mimeType?

```ts
optional mimeType: string;
```

MIME type of the file.
Example - image/jpeg

##### name?

```ts
optional name: string;
```

Name of the file including extension.
Example - profile-picture.jpg

##### size?

```ts
optional size: number;
```

Size of the file in bytes.
Example - 245678

##### updatedAt?

```ts
optional updatedAt: string;
```

Timestamp when the file was last updated.
Example - 2023-01-16T09:45:32Z
Format - date-time

##### uploadedByUserId?

```ts
optional uploadedByUserId: string;
```

ID of the user who uploaded the file.
Example - abc123def456

---

### FileSummary

Basic information about a file in storage.

#### Properties

##### bucketId?

```ts
optional bucketId: string;
```

ID of the bucket containing the file.
Example - users-bucket

##### id?

```ts
optional id: string;
```

Unique identifier for the file.
Example - d5e76ceb-77a2-4153-b7da-1f7c115b2ff2

##### isUploaded?

```ts
optional isUploaded: boolean;
```

Whether the file has been successfully uploaded.
Example - true

##### name?

```ts
optional name: string;
```

Name of the file including extension.
Example - profile-picture.jpg

---

### GetFileMetadataHeadersParams

#### Properties

##### b?

```ts
optional b: number;
```

##### f?

```ts
optional f: F;
```

##### h?

```ts
optional h: number;
```

##### if-match?

```ts
optional if-match: string;
```

##### if-modified-since?

```ts
optional if-modified-since: string;
```

##### if-none-match?

```ts
optional if-none-match: string;
```

##### if-unmodified-since?

```ts
optional if-unmodified-since: string;
```

##### q?

```ts
optional q: number;
```

##### w?

```ts
optional w: number;
```

---

### GetFileParams

#### Properties

##### b?

```ts
optional b: number;
```

##### f?

```ts
optional f: F;
```

##### h?

```ts
optional h: number;
```

##### if-match?

```ts
optional if-match: string;
```

##### if-modified-since?

```ts
optional if-modified-since: string;
```

##### if-none-match?

```ts
optional if-none-match: string;
```

##### if-unmodified-since?

```ts
optional if-unmodified-since: string;
```

##### q?

```ts
optional q: number;
```

##### w?

```ts
optional w: number;
```

---

### PresignedURLResponse

Contains a presigned URL for direct file operations.

#### Properties

##### expiration?

```ts
optional expiration: number;
```

The time in seconds until the URL expires.
Example - 3600

##### url?

```ts
optional url: string;
```

The presigned URL for file operations.
Example - https://storage.example.com/files/abc123?signature=xyz

---

### ReplaceFileBody

#### Properties

##### file?

```ts
optional file: Blob;
```

New file content to replace the existing file
Format - binary

##### metadata?

```ts
optional metadata: UpdateFileMetadata;
```

Metadata that can be updated for an existing file.

---

### ReplaceFileBodyMetadata

Metadata that can be updated for an existing file.

#### Properties

##### metadata?

```ts
optional metadata: Record<string, any>;
```

Updated custom metadata to associate with the file.

##### name?

```ts
optional name: string;
```

New name to assign to the file.
Example - renamed-file.jpg

---

### UpdateFileMetadata

Metadata that can be updated for an existing file.

#### Properties

##### metadata?

```ts
optional metadata: Record<string, any>;
```

Updated custom metadata to associate with the file.

##### name?

```ts
optional name: string;
```

New name to assign to the file.
Example - renamed-file.jpg

---

### UploadFileMetadata

Metadata provided when uploading a new file.

#### Properties

##### id?

```ts
optional id: string;
```

Optional custom ID for the file. If not provided, a UUID will be generated.
Example - custom-id-123

##### metadata?

```ts
optional metadata: Record<string, any>;
```

Custom metadata to associate with the file.

##### name?

```ts
optional name: string;
```

Name to assign to the file. If not provided, the original filename will be used.
Example - custom-filename.png

---

### UploadFiles201

#### Properties

##### processedFiles?

```ts
optional processedFiles: FileMetadata[];
```

List of successfully processed files with their metadata.

---

### UploadFilesBody

#### Properties

##### bucket-id?

```ts
optional bucket-id: string;
```

Target bucket identifier where files will be stored.
Example - user-uploads

##### file\[\]

```ts
file[]: Blob[];
```

Array of files to upload.

##### metadata\[\]?

```ts
optional metadata[]: UploadFileMetadata[];
```

Optional custom metadata for each uploaded file. Must match the order of the file[] array.

---

### VersionInformation

Contains version information about the storage service.

#### Properties

##### buildVersion?

```ts
optional buildVersion: string;
```

The version number of the storage service build.
Example - 1.2.3

## Functions

### createAPIClient()

```ts
function createAPIClient(
  baseURL: string,
  chainFunctions: ChainFunction[],
): Client;
```

#### Parameters

| Parameter        | Type                                         | Default value |
| ---------------- | -------------------------------------------- | ------------- |
| `baseURL`        | `string`                                     | `undefined`   |
| `chainFunctions` | [`ChainFunction`](fetch#chainfunction)[] | `[]`          |

#### Returns

[`Client`](#client)
